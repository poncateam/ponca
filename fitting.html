<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ponca: Fitting Module: User Manual</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSsymbols.js", "TeX/AMSmath.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="ponca.css" rel="stylesheet" type="text/css"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
</script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
    DoxygenAwesomeParagraphLink.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ponca
   &#160;<span id="projectnumber">de97cad77925d7d2caa263a719aec81f3d2f988f</span>
   </div>
   <div id="projectbrief">Point Cloud Analysis library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('fitting.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Fitting Module: User Manual</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#fitting_intro">Introduction</a><ul><li class="level2"><a href="#fitting_design">Design choices and programing techniques</a></li>
<li class="level2"><a href="#fitting_primitiveOverview">Fitting primitives and compute neighborhood properties</a></li>
<li class="level2"><a href="#fitting_availableFunctionalities">Fitting techniques overview</a></li>
<li class="level2"><a href="#fitting_dicStructure">Structure of the documentation</a></li>
</ul>
</li>
<li class="level1"><a href="#fitting_firstSteps">First Steps</a><ul><li class="level2"><a href="#fitting_codeStructure">Include directives</a></li>
<li class="level2"><a href="#fitting_datas">Data Samples</a></li>
<li class="level2"><a href="#fitting_Define">Definition of the Fitting object</a></li>
<li class="level2"><a href="#fitting_Fitting">Fitting Process</a></li>
<li class="level2"><a href="#fitting_Checkstatus">Check fitting status</a></li>
<li class="level2"><a href="#fitting_outputs">Basic Outputs</a></li>
</ul>
</li>
<li class="level1"><a href="#fitting_advanced">Advanced usage</a><ul><li class="level2"><a href="#fitting_derivatives">Computing derivatives</a></li>
<li class="level2"><a href="#fitting_extensions_deps">Computational objets, basket and CRTP</a></li>
<li class="level2"><a href="#fitting_capabilities">Computational objets capabilities and requirements</a></li>
<li class="level2"><a href="#fitting_multiprimitive">Sharing computations between fits</a></li>
<li class="level2"><a href="#fitting_cuvature">Computing Curvatures</a></li>
<li class="level2"><a href="#fitting_cuda">Cuda</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><center>[<a class="el" href="user_manual_page.html">Go back to user manual</a>]</center> <center>[<a class="el" href="fitting_concepts.html">Go to concept page</a>]</center><h1><a class="anchor" id="fitting_intro"></a>
Introduction</h1>
<p>The fitting module is dedicated to the smooth fitting of point clouds and extraction of useful geometric properties. Figure 1(a) shows a typical example in 2D: we reconstruct a potential function (shown in fake colors) from a few 2D points equipped with normals; then the 0-isoline of this potential gives us an implicit curve (in orange) from which we can readily extract further properties like curvature. A great benefit of this implicit technique <a class="el" href="citelist.html#CITEREF_Guennebaud:2007:APSS">[6]</a> is that it works in arbitrary dimensions: Figures 1(b-c) show how we reconstruct an implicit 3D surface with the same approach, starting from a 3D point cloud. Working with meshes then simply consists of only considering their vertices.</p>
<div class="image">
<img src="interpolation.png" alt=""/>
<div class="caption">
Figure 1: (a) An implicit 2D curve fit to a 2D point cloud. (b) A 3D point cloud shown with splats. (c) An implicit 3D surface reconstructed from (b).</div></div>
<p>This is just the tip of the iceberg though, as we also provide methods for dealing with points equipped with non-oriented normals <a class="el" href="citelist.html#CITEREF_Chen:2013:NOMG">[4]</a>, techniques to analyze points clouds in scale-space to discover salient structures <a class="el" href="citelist.html#CITEREF_Mellado:2012:GLS">[11]</a>, methods to compute multi-scale principal curvatures <a class="el" href="citelist.html#CITEREF_Mellado:2013:SSC">[12]</a> and methods to compute surface variation using a plane instead of a sphere for the fitting <a class="el" href="citelist.html#CITEREF_Pauly:2002:PSSimplification">[13]</a>.</p>
<h2><a class="anchor" id="fitting_design"></a>
Design choices and programing techniques</h2>
<p>The goal of this module is to provide lightweight, fast and generic algorithms for 3d point cloud processing. We mostly focus on local regression techniques, which are core components of surface reconstruction techniques <a class="el" href="citelist.html#CITEREF_Alexa:2001:Pss">[2]</a> <a class="el" href="citelist.html#CITEREF_Guennebaud:2007:APSS">[6]</a>, geometric descriptors <a class="el" href="citelist.html#CITEREF_Mellado:2012:GLS">[11]</a> <a class="el" href="citelist.html#CITEREF_Lejemble:2021:stable">[9]</a> or shape analysis techniques <a class="el" href="citelist.html#CITEREF_lejemble:2020:persistence">[8]</a>. Most of these techniques share similar computation, and can be combined in several ways. For instance, <a class="el" href="classPonca_1_1NormalDerivativesCurvatureEstimator.html">NormalDerivativesCurvatureEstimator</a> estimates curvature values by analyzing the spatial derivatives of a normal field, and can be combined with any normal estimation technique.</p>
<p>In order to ease the association of multiple computational components, the library is based on the Curiously Recurring Template Pattern (CRTP). In contrast with polymorphism, this method allows to combine multiple short computations without adding runtime overhead (both in terms of memory footprint and execution time). Instead, the combination of the computational components is performed and optimized when compiling the program, and thus require more memory and time for this stage.</p>
<p>Because of some properties of the C++ language, our classes does not inherit from a <code>Base</code> interface defining the API, but rather follows concepts, as described in <a class="el" href="fitting_concepts.html">Fitting module: Concepts</a>.</p>
<h2><a class="anchor" id="fitting_primitiveOverview"></a>
Fitting primitives and compute neighborhood properties</h2>
<p>The fitting module provides a unified API to perform computations (e.g. fit a <a class="el" href="classPonca_1_1PrimitiveBase.html">Primitive</a>, compute geometrical properties such as <a class="el" href="classPonca_1_1CurvatureEstimatorBase.html">Curvatures</a>) over the neighborhood of a given point. The type of computation is controlled by a type (called <code>Fit</code> in the example below) defined by the user by combining computational components offered in this module. Given an object of type <code>Fit</code>, the client code will always looks as follows: </p><div class="fragment"><div class="line">Fit fit;                             <span class="comment">// Create the user-defined fitting procedure</span></div>
<div class="line">fit.init();                          <span class="comment">// Initialize internal state</span></div>
<div class="line">fit.setWeightFunc(WeightFunc(p, t)); <span class="comment">// Set a weighting function to weight neighbors from a reference point p</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; it = vecs.begin(); it != vecs.end(); it++)</div>
<div class="line">  fit.addNeighbor(*it);              <span class="comment">// Traverse neighborhood</span></div>
<div class="line">fit.finalize();                      <span class="comment">// Finalize computations</span></div>
</div><!-- fragment --><p>Once computations are done, the <code>Fit</code> object provides both getters to the neighborhood properties (e.g. estimated curvature), and procedures (e.g. projection operator onto the fitted primitive): </p><div class="fragment"><div class="line">cout &lt;&lt; <span class="stringliteral">&quot;Estimated mean curvature: &quot;</span> &lt;&lt; fit.kMean()        &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">     &lt;&lt; <span class="stringliteral">&quot;The initial point &quot;</span> &lt;&lt; p.transpose()              &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">     &lt;&lt; <span class="stringliteral">&quot;Is projected at   &quot;</span> &lt;&lt; fit.project(p).transpose() &lt;&lt; endl;</div>
</div><!-- fragment --><p>The <a class="el" href="spatialpartitioning.html">Spatial Partitioning</a> module provides data-structures to collect neighborhood in point clouds.</p>
<h2><a class="anchor" id="fitting_availableFunctionalities"></a>
Fitting techniques overview</h2>
<p>We provide various approaches to approximate, analyze or characterize the geometric properties of local neighborhoods. In most situations, all these tools are based on the estimation of a geometric <a class="el" href="classPonca_1_1PrimitiveBase.html">Primitive</a> approximating the neighborhood, on top of which we provide more advanced computations. The table below summarizes the <a class="el" href="classPonca_1_1PrimitiveBase.html">Primitives</a> available in the library, as well as the associated fitting techniques:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Primitive   </th><th class="markdownTableHeadNone">Required Input   </th><th class="markdownTableHeadNone">Fitting techniques    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Barycenter   </td><td class="markdownTableBodyNone">Points only   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MeanPosition.html" title="Compute the barycenter of the input points.">MeanPosition</a> (nD)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Normal Vector   </td><td class="markdownTableBodyNone">Oriented points   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MeanNormal.html" title="Compute the barycenter of the input points + their normals.">MeanNormal</a> (nD, co-dimension 1)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Covariance Matrix   </td><td class="markdownTableBodyNone">Points only   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CovarianceFitBase.html" title="Procedure that compute and decompose the covariance matrix of the neighbors positions in .">CovarianceFitBase</a> (nD)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1Line.html" title="A parametrized line is defined by an origin point  and a unit direction vector  such that the line co...">Line</a>   </td><td class="markdownTableBodyNone">Points only   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CovarianceLineFitImpl.html" title="Line fitting procedure that minimize the orthogonal distance between the samples and the fitted primi...">CovarianceLineFitImpl</a> (nD)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1Plane.html" title="Implicit hyperplane defined by an homogeneous vector .">Plane</a>   </td><td class="markdownTableBodyNone">Points only   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CovariancePlaneFitImpl.html" title="Plane fitting procedure using only points position.">CovariancePlaneFitImpl</a> (nD)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1Plane.html" title="Implicit hyperplane defined by an homogeneous vector .">Plane</a>   </td><td class="markdownTableBodyNone">Oriented points   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MeanPlaneFitImpl.html" title="Plane fitting procedure computing the mean position and orientation from oriented points.">MeanPlaneFitImpl</a> (nD, co-dimension 1)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MongePatch.html" title="Extension to compute the best fit quadric on 3d points expressed as .">MongePatch</a>   </td><td class="markdownTableBodyNone">Points only   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MongePatch.html" title="Extension to compute the best fit quadric on 3d points expressed as .">MongePatch</a> (3D)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1AlgebraicSphere.html" title="Algebraic Sphere primitive.">AlgebraicSphere</a>   </td><td class="markdownTableBodyNone">Points only   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1SphereFitImpl.html" title="Algebraic Sphere fitting procedure on point set without normals.">SphereFitImpl</a> (nD) <a class="el" href="citelist.html#CITEREF_Guennebaud:2007:APSS">[6]</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1AlgebraicSphere.html" title="Algebraic Sphere primitive.">AlgebraicSphere</a>   </td><td class="markdownTableBodyNone">Oriented points   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1OrientedSphereFitImpl.html" title="Algebraic Sphere fitting procedure on oriented point sets.">OrientedSphereFitImpl</a> (nD) <a class="el" href="citelist.html#CITEREF_Guennebaud:2007:APSS">[6]</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1AlgebraicSphere.html" title="Algebraic Sphere primitive.">AlgebraicSphere</a>   </td><td class="markdownTableBodyNone">Non-oriented points   </td><td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1UnorientedSphereFitImpl.html" title="Algebraic Sphere fitting procedure on point sets with non-oriented normals.">UnorientedSphereFitImpl</a> (nD) <a class="el" href="citelist.html#CITEREF_Chen:2013:NOMG">[4]</a>   </td></tr>
</table>
<p>See section <a class="el" href="fitting.html#fitting_extensions_deps">Computational objets, basket and CRTP</a> for more details on how these primitives can be extended for more advanced computation.</p>
<h2><a class="anchor" id="fitting_dicStructure"></a>
Structure of the documentation</h2>
<p>In the following, we focus on a basic use of the module, and detail how to:</p><ul>
<li>set up data samples that interface with an external code (see Section <a class="el" href="fitting.html#fitting_datas">Data Samples</a>),</li>
<li>assemble the computational objects to define a fitting object (see Section <a class="el" href="fitting.html#fitting_Define">Definition of the Fitting object</a>)</li>
<li>run the fitting process in itself (see Section <a class="el" href="fitting.html#fitting_Fitting">Fitting Process</a>),</li>
<li>and finally collect outputs (see Section <a class="el" href="fitting.html#fitting_outputs">Basic Outputs</a>).</li>
</ul>
<p>We also show detail all the available tools for geometrical property estimation (see Section <a class="el" href="fitting.html#fitting_extensions_deps">Computational objets, basket and CRTP</a>), with a specific focus on curvature (see Section <a class="el" href="fitting.html#fitting_cuvature">Computing Curvatures</a>). The last section details how to use this module on CUDA kernels (see Section <a class="el" href="fitting.html#fitting_cuda">Cuda</a>).</p>
<h1><a class="anchor" id="fitting_firstSteps"></a>
First Steps</h1>
<h2><a class="anchor" id="fitting_codeStructure"></a>
Include directives</h2>
<p>The Fitting module defines operators that rely on no data structure and work both with CUDA and C++. These core operators implement atomic scientific contributions that are agnostic of the host application. If you want to use the Fitting module, just include its header: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;Ponca/Fitting&quot;</span></div>
</div><!-- fragment --><h2><a class="anchor" id="fitting_datas"></a>
Data Samples</h2>
<p>The first step needed to use <a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> is to define how samples are represented inside the module. A strength of <a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> is to define all these structures at compile time to generate optimized code for fast evaluation at runtime.</p>
<p>The class Ponca::Concept::PointConcept defines the interface that has to be implemented to represent a sample. Observe that there is no need for data conversion: all you need to do is to indicate how to access existing data (see the example <a class="el" href="example_cxx_binding_page.html">Ponca data-structure binding</a>).</p>
<p>As an example, let's fit a <a class="el" href="classPonca_1_1AlgebraicSphere.html" title="Algebraic Sphere primitive.">AlgebraicSphere</a> onto points equipped with normals using <a class="el" href="namespacePonca.html#a2f53f5c61ca5df7c3e3f8cf2219a14d4" title="Helper alias for Oriented Sphere fitting on 3D points using OrientedSphereFitImpl [OrientedSphereFit ...">Ponca::OrientedSphereFit</a>. To this end, we must define a structure (denoted <code>PointPositionNormal</code> in the example below) containing a normal vector and its associated accessors. Depending on the fitting procedure we will use, we may need to define a <code>MatrixType</code> type. This is for instance required for <a class="el" href="fitting.html#fitting_cuvature">Computing Curvatures</a>. This leads to the following class: </p><div class="fragment"><div class="line"><span class="comment">// Point with position and normal vector</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Scalar, <span class="keywordtype">int</span> _Dim&gt;</div>
<div class="line"><span class="keyword">class </span>PointPositionNormal</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">enum</span> {Dim = _Dim};</div>
<div class="line">    <span class="keyword">typedef</span> _Scalar Scalar;</div>
<div class="line">    <span class="keyword">typedef</span> Eigen::Matrix&lt;Scalar, Dim,   1&gt;     VectorType;</div>
<div class="line">    <span class="keyword">typedef</span> Eigen::Matrix&lt;Scalar, Dim, Dim&gt; MatrixType;</div>
<div class="line"> </div>
<div class="line">    PONCA_MULTIARCH <span class="keyword">inline</span> PointPositionNormal(</div>
<div class="line">            <span class="keyword">const</span> VectorType &amp;pos = VectorType::Zero(),</div>
<div class="line">            <span class="keyword">const</span> VectorType&amp; normal = VectorType::Zero() )</div>
<div class="line">        : m_pos(pos), m_normal(normal) {}</div>
<div class="line"> </div>
<div class="line">    PONCA_MULTIARCH <span class="keyword">inline</span> <span class="keyword">const</span> VectorType&amp; pos()<span class="keyword">    const </span>{ <span class="keywordflow">return</span> m_pos; }</div>
<div class="line">    PONCA_MULTIARCH <span class="keyword">inline</span> <span class="keyword">const</span> VectorType&amp; normal()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m_normal; }</div>
<div class="line"> </div>
<div class="line">    PONCA_MULTIARCH <span class="keyword">inline</span> VectorType&amp; pos()    { <span class="keywordflow">return</span> m_pos; }</div>
<div class="line">    PONCA_MULTIARCH <span class="keyword">inline</span> VectorType&amp; normal() { <span class="keywordflow">return</span> m_normal; }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    VectorType m_pos, m_normal;</div>
<div class="line">};</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>The macro <code>PONCA_MULTIARCH</code> is optional and required only for <a class="el" href="fitting.html#fitting_cuda">Cuda</a> support.</dd></dl>
<p><code>PointPositionNormal</code> needs to be specialized for any scalar type or dimension (you may also use a non-template class directly): </p><div class="fragment"><div class="line">    <span class="keyword">typedef</span> PointPositionNormal&lt;Scalar, Dim&gt; Point;</div>
</div><!-- fragment --><h2><a class="anchor" id="fitting_Define"></a>
Definition of the Fitting object</h2>
<p>Two template classes must be specialized to configure computations.</p>
<ol type="1">
<li>The first step consists in specifying a weighting function: it defines how neighbor samples will contribute to the fit, as illustrated in Figure 2(a) in 2D. In this example, we choose a weight based on the Euclidean distance using <a class="el" href="classPonca_1_1DistWeightFunc.html" title="Weighting function based on the euclidean distance between a query and a reference position.">Ponca::DistWeightFunc</a>, remapped through a bisquare kernel defined in <a class="el" href="classPonca_1_1SmoothWeightKernel.html" title="Smooth WeightKernel of 2nd degree, defined in  Special case of PolynomialSmoothWeightKernel&lt;Scalar,...">Ponca::SmoothWeightKernel</a>: <div class="fragment"><div class="line">    <span class="keyword">using </span>WeightFunc = DistWeightFunc&lt;Point, SmoothWeightKernel&lt;Scalar&gt; &gt;;</div>
</div><!-- fragment --></li>
<li>The second step identifies a complete fitting procedure through the specialization of a <a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Ponca::Basket</a>. In our example, we want to apply an <a class="el" href="namespacePonca.html#a2f53f5c61ca5df7c3e3f8cf2219a14d4" title="Helper alias for Oriented Sphere fitting on 3D points using OrientedSphereFitImpl [OrientedSphereFit ...">Ponca::OrientedSphereFit</a> to input data points, which outputs an <a class="el" href="classPonca_1_1AlgebraicSphere.html" title="Algebraic Sphere primitive.">Ponca::AlgebraicSphere</a> by default. This leads to the following specialization: <div class="fragment"><div class="line">    <span class="keyword">using </span>Sphere = Basket&lt;Point, WeightFunc, OrientedSphereFit&gt;;</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="fitting_Fitting"></a>
Fitting Process</h2>
<p>At this point, most of the hard job has already been performed. All we have to do now is to provide an instance of the weight function, where \(t\) refers to the neighborhood size, and initiate the fit at an arbitrary position \(\mathbf{p}\). </p><div class="fragment"><div class="line">        Fit fit1;</div>
<div class="line">        fit1.setWeightFunc(WeightFunc(fitInitPos, analysisScale));</div>
<div class="line">        fit1.init();</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keyword">auto</span> it = vectorPoints.begin(); it != vectorPoints.end(); ++it)</div>
<div class="line">           fit1.addNeighbor(*it);</div>
<div class="line">        fit1.finalize();</div>
</div><!-- fragment --><p>Then neighbors are added sequentially: in this example, we traverse a simple array, and samples outside of the neighborhood are automatically ignored by the weighting function. Once all neighbors have been incorporated, the fit is performed and results stored in the specialized <a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a> object. STL-like iterators can be used directly for the fit by calling </p><div class="fragment"><div class="line">        Fit fit2;</div>
<div class="line">        fit2.setWeightFunc(WeightFunc(fitInitPos, analysisScale));</div>
<div class="line">        fit2.compute(vectorPoints);</div>
</div><!-- fragment --><p>Spatial structures can be used to accelerate spatial queries. Consider for instance using the <a class="el" href="structPonca_1_1KdTree.html" title="Abstract KdTree type with KdTreeDefaultTraits.">KdTree</a> class with range queries: </p><div class="fragment"><div class="line">        Fit fit3;</div>
<div class="line">        fit3.setWeightFunc(WeightFunc(fitInitPos, analysisScale));</div>
<div class="line">        <span class="comment">// Sort fit1</span></div>
<div class="line">        std::list&lt;int&gt; neighbors3;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iNeighbor : tree.range_neighbors(fitInitPos, analysisScale))</div>
<div class="line">            neighbors3.push_back(iNeighbor);</div>
<div class="line">        neighbors3.sort();</div>
<div class="line">        <span class="comment">// Compute the neighbors</span></div>
<div class="line">        fit3.computeWithIds( neighbors3, vectorPoints );</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Currently, users need to ensure consistency between the query and the fit location/scale. This is expected to be fixed in the upcoming releases.</dd></dl>
<p>In these examples, <code>fit1</code>, <code>fit2</code> and <code>fit3</code> should perform exactly the same computations, as long a the neighborhood remains the same between the three calls.</p>
<h2><a class="anchor" id="fitting_Checkstatus"></a>
Check fitting status</h2>
<p>After calling <code>finalize</code> or <code>compute</code>, it is recommended to test the return state of the <code>Fit</code> object before using it:</p>
<div class="fragment"><div class="line"><a class="code hl_enumeration" href="namespacePonca.html#abfd697aebf07c1b5c8be5ee401e2dc84">FIT_RESULT</a> eResult = fit.compute(vecs.begin(), vecs.end()); <span class="comment">// or eResult = fit.finalize();</span></div>
<div class="line"><span class="keywordflow">if</span>(eResult == <a class="code hl_enumvalue" href="namespacePonca.html#abfd697aebf07c1b5c8be5ee401e2dc84a86d1e5381a39092fbe5560583c23d64c">STABLE</a>)                                       <span class="comment">// or fit.isStable()</span></div>
<div class="line">      <span class="comment">//do your things...</span></div>
<div class="ttc" id="anamespacePonca_html_abfd697aebf07c1b5c8be5ee401e2dc84"><div class="ttname"><a href="namespacePonca.html#abfd697aebf07c1b5c8be5ee401e2dc84">Ponca::FIT_RESULT</a></div><div class="ttdeci">FIT_RESULT</div><div class="ttdoc">Enum corresponding to the state of a fitting method (and what the finalize function returns)</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00014">enums.h:15</a></div></div>
<div class="ttc" id="anamespacePonca_html_abfd697aebf07c1b5c8be5ee401e2dc84a86d1e5381a39092fbe5560583c23d64c"><div class="ttname"><a href="namespacePonca.html#abfd697aebf07c1b5c8be5ee401e2dc84a86d1e5381a39092fbe5560583c23d64c">Ponca::STABLE</a></div><div class="ttdeci">@ STABLE</div><div class="ttdoc">The fitting is stable and ready to use.</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00017">enums.h:17</a></div></div>
</div><!-- fragment --><p>Some methods require multiple fitting passes, e.g. <a class="el" href="classPonca_1_1MongePatch.html">MongePatch</a>. This is directly handled by the <code>compute</code> method. If you don't use it, you need to check if <code>eResults == NEED_ANOTHER_PASS</code> and repeat the <code>addNeighbor()</code>/<code>finalize()</code> steps. Don't forget to call <code>startNewPass()</code> at each iteration.</p>
<dl class="section warning"><dt>Warning</dt><dd>You should avoid data of low magnitude (i.e., 1 should be a significant value) to get good results; thus rescaling might be necessary.</dd></dl>
<h2><a class="anchor" id="fitting_outputs"></a>
Basic Outputs</h2>
<div class="image">
<img src="gls.png" alt=""/>
<div class="caption">
Figure 2. (a) Fitting a 2D point cloud of positions and normals at a point p (in red) requires to define a weight function of size t (in green). (b) This results in an implicit scalar field (in fake colors), from which parameters of a local spherical surface can be extracted: an offset tau, a normal eta and a curvature kappa.</div></div>
<p>Now that you have performed fitting, you may use its outputs in a number of ways (see Figure 2(b) for an illustration in 2D).</p>
<p>You may directly access generic properties of the fitted <a class="el" href="classPonca_1_1PrimitiveBase.html">Primitive</a>: </p><div class="fragment"><div class="line">cout &lt;&lt; <span class="stringliteral">&quot;Value of the scalar field at the initial point: &quot;</span> &lt;&lt; p.transpose()</div>
<div class="line">     &lt;&lt; <span class="stringliteral">&quot; is equal to &quot;</span> &lt;&lt; fit.potential(p) &lt;&lt; endl;</div>
<div class="line">cout &lt;&lt; <span class="stringliteral">&quot;Its gradient is equal to: &quot;</span> &lt;&lt; fit.primitiveGradient(p).transpose() &lt;&lt; endl;</div>
</div><!-- fragment --><p> This generates the following output: </p><div class="fragment"><div class="line">Value of the scalar field at the initial point: 0 0 0 is equal to -0.501162</div>
<div class="line">Its gradient is equal to:   0.00016028  0.000178782 -0.000384989</div>
</div><!-- fragment --><p>You may rather access properties of the fitted sphere (the 0-isosurface of the fitted scalar field), as defined in <a class="el" href="classPonca_1_1AlgebraicSphere.html" title="Algebraic Sphere primitive.">AlgebraicSphere</a> : </p><div class="fragment"><div class="line">cout &lt;&lt; <span class="stringliteral">&quot;Center: [&quot;</span> &lt;&lt; fit.center().transpose() &lt;&lt; <span class="stringliteral">&quot;] ;  radius: &quot;</span> &lt;&lt; fit.radius() &lt;&lt; endl;</div>
<div class="line">cout &lt;&lt; <span class="stringliteral">&quot;The initial point &quot;</span> &lt;&lt; p.transpose()              &lt;&lt; endl</div>
<div class="line">     &lt;&lt; <span class="stringliteral">&quot;Is projected at   &quot;</span> &lt;&lt; fit.project(p).transpose() &lt;&lt; endl;</div>
</div><!-- fragment --><p> You will obtain: </p><div class="fragment"><div class="line">Center: [-0.000160652 -0.000179197  0.000385884] ;  radius: 1.00232</div>
<div class="line">The initial point 0 0 0</div>
<div class="line">Is projected at    0.353911  0.394765 -0.850088</div>
</div><!-- fragment --><h1><a class="anchor" id="fitting_advanced"></a>
Advanced usage</h1>
<h2><a class="anchor" id="fitting_derivatives"></a>
Computing derivatives</h2>
<p>Starting from v1.0, <a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> provides <a class="el" href="classPonca_1_1BasketDiff.html" title="Aggregator class used to declare specialized structures with derivatives computations,...">BasketDiff</a>, a class to extend an existing <a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a> with differentiation tools. Given a specialized type <code>TestPlane</code> that performs covariance plane fitting (using <a class="el" href="namespacePonca.html#aa4b1806ad54a3b70849bd5997002a8c7" title="Helper alias for Plane fitting on 3D points using CovariancePlaneFitImpl [CovariancePlaneFit Definiti...">Ponca::CovariancePlaneFit</a>), and defined as follows: </p><div class="fragment"><div class="line">    <span class="keyword">using </span>TestPlane = Basket&lt;Point, WeightFunc, CovariancePlaneFit&gt;;</div>
</div><!-- fragment --><p> <a class="el" href="classPonca_1_1BasketDiff.html" title="Aggregator class used to declare specialized structures with derivatives computations,...">BasketDiff</a> allows to extend this type to compute its derivatives in space and/or scale: </p><div class="fragment"><div class="line">    <span class="keyword">using </span>PlaneScaleDiff = BasketDiff&lt;TestPlane, FitScaleDer, CovariancePlaneDer&gt;;</div>
<div class="line">    <span class="keyword">using </span>PlaneSpaceDiff = BasketDiff&lt;TestPlane, FitSpaceDer, CovariancePlaneDer&gt;;</div>
<div class="line">    <span class="keyword">using </span>PlaneScaleSpaceDiff = BasketDiff&lt;TestPlane, FitScaleSpaceDer, CovariancePlaneDer&gt;;</div>
</div><!-- fragment --><h2><a class="anchor" id="fitting_extensions_deps"></a>
Computational objets, basket and CRTP</h2>
<p>In addition to Primitive fitting, <a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> allows to compute geometrical properties of the input samples. This is done by aggregating multiple tool classes in the <a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>, for instance to compute the Growing Least Squares descriptor <a class="el" href="citelist.html#CITEREF_Mellado:2012:GLS">[11]</a> (see <a class="el" href="classPonca_1_1GLSParam.html" title="Growing Least Squares reparemetrization of the OrientedSphereFit.">GLSParam</a>) from multiple sphere fitting techniques: </p><div class="fragment"><div class="line">    <span class="keyword">typedef</span> Basket&lt;Point, WeightSmoothFunc, OrientedSphereFit, GLSParam&gt; FitSmoothOriented;</div>
<div class="line">    <span class="keyword">typedef</span> Basket&lt;Point, WeightConstantFunc, OrientedSphereFit, GLSParam&gt; FitConstantOriented;</div>
<div class="line">    <span class="keyword">typedef</span> Basket&lt;Point, WeightSmoothFunc, UnorientedSphereFit, GLSParam&gt; FitSmoothUnoriented;</div>
<div class="line">    <span class="keyword">typedef</span> Basket&lt;Point, WeightConstantFunc, UnorientedSphereFit, GLSParam&gt; FitConstantUnoriented;</div>
</div><!-- fragment --><p> From a technical point of view, the <a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a> class combines its template parameters (here <a class="el" href="namespacePonca.html#a2f53f5c61ca5df7c3e3f8cf2219a14d4" title="Helper alias for Oriented Sphere fitting on 3D points using OrientedSphereFitImpl [OrientedSphereFit ...">Ponca::OrientedSphereFit</a> and <a class="el" href="classPonca_1_1GLSParam.html" title="Growing Least Squares reparemetrization of the OrientedSphereFit.">GLSParam</a>) following the CRTP rules, ie. to form an object of the type <code><a class="el" href="classPonca_1_1GLSParam.html" title="Growing Least Squares reparemetrization of the OrientedSphereFit.">GLSParam</a>&lt;<a class="el" href="namespacePonca.html#a2f53f5c61ca5df7c3e3f8cf2219a14d4" title="Helper alias for Oriented Sphere fitting on 3D points using OrientedSphereFitImpl [OrientedSphereFit ...">Ponca::OrientedSphereFit</a>&lt;DataPoint, _WFunctor,T&gt;&gt;</code>, that aggregates the computations provided in each class of the hierarchy.</p>
<p>In practice, <a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> uses these mechanisms under the hood in order to combine atomic computations and minimize code duplication. For instance, <a class="el" href="namespacePonca.html#a2f53f5c61ca5df7c3e3f8cf2219a14d4" title="Helper alias for Oriented Sphere fitting on 3D points using OrientedSphereFitImpl [OrientedSphereFit ...">Ponca::OrientedSphereFit</a> is defined as an assembly of several computations classes: </p><div class="fragment"><div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="keyword">template</span> &lt; <span class="keyword">class</span> DataPo<span class="keywordtype">int</span>, <span class="keyword">class</span> _WFunctor, <span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="keyword">using </span><a class="code hl_typedef" href="namespacePonca.html#a2f53f5c61ca5df7c3e3f8cf2219a14d4">OrientedSphereFit</a> =</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>OrientedSphereFitImpl&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>        MeanPosition&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>            MeanNormal&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>                AlgebraicSphere&lt;DataPoint, _WFunctor,T&gt;&gt;&gt;&gt;;</div>
<div class="ttc" id="anamespacePonca_html_a2f53f5c61ca5df7c3e3f8cf2219a14d4"><div class="ttname"><a href="namespacePonca.html#a2f53f5c61ca5df7c3e3f8cf2219a14d4">Ponca::OrientedSphereFit</a></div><div class="ttdeci">OrientedSphereFitImpl&lt; DataPoint, _WFunctor, MeanPosition&lt; DataPoint, _WFunctor, MeanNormal&lt; DataPoint, _WFunctor, AlgebraicSphere&lt; DataPoint, _WFunctor, T &gt; &gt; &gt; &gt; OrientedSphereFit</div><div class="ttdoc">Helper alias for Oriented Sphere fitting on 3D points using OrientedSphereFitImpl [OrientedSphereFit ...</div><div class="ttdef"><b>Definition</b> <a href="orientedSphereFit_8h_source.html#l00052">orientedSphereFit.h:56</a></div></div>
</div><!-- fragment --><p> Here, the class <a class="el" href="classPonca_1_1MeanPosition.html" title="Compute the barycenter of the input points.">MeanPosition</a> computes the mean position of the input points. It is also used in <a class="el" href="namespacePonca.html#aa4b1806ad54a3b70849bd5997002a8c7" title="Helper alias for Plane fitting on 3D points using CovariancePlaneFitImpl [CovariancePlaneFit Definiti...">Ponca::CovariancePlaneFit</a>: </p><div class="fragment"><div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="keyword">template</span> &lt; <span class="keyword">class</span> DataPo<span class="keywordtype">int</span>, <span class="keyword">class</span> _WFunctor, <span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="keyword">using </span><a class="code hl_typedef" href="namespacePonca.html#aa4b1806ad54a3b70849bd5997002a8c7">CovariancePlaneFit</a> =</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    CovariancePlaneFitImpl&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>            CovarianceFitBase&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                    MeanPosition&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                            Plane&lt;DataPoint, _WFunctor,T&gt;&gt;&gt;&gt;;</div>
<div class="ttc" id="anamespacePonca_html_aa4b1806ad54a3b70849bd5997002a8c7"><div class="ttname"><a href="namespacePonca.html#aa4b1806ad54a3b70849bd5997002a8c7">Ponca::CovariancePlaneFit</a></div><div class="ttdeci">CovariancePlaneFitImpl&lt; DataPoint, _WFunctor, CovarianceFitBase&lt; DataPoint, _WFunctor, MeanPosition&lt; DataPoint, _WFunctor, Plane&lt; DataPoint, _WFunctor, T &gt; &gt; &gt; &gt; CovariancePlaneFit</div><div class="ttdoc">Helper alias for Plane fitting on 3D points using CovariancePlaneFitImpl [CovariancePlaneFit Definiti...</div><div class="ttdef"><b>Definition</b> <a href="covariancePlaneFit_8h_source.html#l00087">covariancePlaneFit.h:91</a></div></div>
</div><!-- fragment --><p> and <a class="el" href="namespacePonca.html#a13ebe442f2119e12b35714a12a15560b" title="Helper alias for Plane fitting on points using MeanPlaneFitImpl [MeanPlaneFit Definition].">Ponca::MeanPlaneFit</a>, among others. </p><div class="fragment"><div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    <span class="keyword">template</span> &lt; <span class="keyword">class</span> DataPo<span class="keywordtype">int</span>, <span class="keyword">class</span> _WFunctor, <span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    <span class="keyword">using </span><a class="code hl_typedef" href="namespacePonca.html#a13ebe442f2119e12b35714a12a15560b">MeanPlaneFit</a> =</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    MeanPlaneFitImpl&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        MeanNormal&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>            MeanPosition&lt;DataPoint, _WFunctor,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>                Plane&lt;DataPoint, _WFunctor,T&gt;&gt;&gt;&gt;;</div>
<div class="ttc" id="anamespacePonca_html_a13ebe442f2119e12b35714a12a15560b"><div class="ttname"><a href="namespacePonca.html#a13ebe442f2119e12b35714a12a15560b">Ponca::MeanPlaneFit</a></div><div class="ttdeci">MeanPlaneFitImpl&lt; DataPoint, _WFunctor, MeanNormal&lt; DataPoint, _WFunctor, MeanPosition&lt; DataPoint, _WFunctor, Plane&lt; DataPoint, _WFunctor, T &gt; &gt; &gt; &gt; MeanPlaneFit</div><div class="ttdoc">Helper alias for Plane fitting on points using MeanPlaneFitImpl [MeanPlaneFit Definition].</div><div class="ttdef"><b>Definition</b> <a href="meanPlaneFit_8h_source.html#l00056">meanPlaneFit.h:60</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="fitting_capabilities"></a>
Computational objets capabilities and requirements</h2>
<p>Aggregating small computational objects allows to minimize code duplication, but also to easily combine different techniques. For instance, <a class="el" href="classPonca_1_1GLSDer.html" title="Differentiation of GLSParam.">GLSDer</a> can be used independently of the fitting technique, e.g. <a class="el" href="namespacePonca.html#a2f53f5c61ca5df7c3e3f8cf2219a14d4" title="Helper alias for Oriented Sphere fitting on 3D points using OrientedSphereFitImpl [OrientedSphereFit ...">Ponca::OrientedSphereFit</a> or <a class="el" href="namespacePonca.html#ac22c4266774d911c5c597d132477c264" title="Helper alias for Oriented Sphere fitting on 3D points using UnorientedSphereFitImpl.">Ponca::UnorientedSphereFit</a>, as long as the fitted <a class="el" href="classPonca_1_1PrimitiveBase.html">Primitive</a> is an <a class="el" href="classPonca_1_1AlgebraicSphere.html" title="Algebraic Sphere primitive.">AlgebraicSphere</a>.</p>
<p>In order to detect if the computational objects are correctly combined, <a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> provides a compile-time equirement/capability system: each computational objects check if the other classes of the CRTP provides the required computations. For instance, in the <a class="el" href="classPonca_1_1GLSParam.html" title="Growing Least Squares reparemetrization of the OrientedSphereFit.">GLSParam</a> class, we define the following enum: </p><div class="fragment"><div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="keyword">protected</span>:</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="keyword">enum</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    {</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>        Check = Base::PROVIDES_ALGEBRAIC_SPHERE,</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>        PROVIDES_GLS_PARAMETRIZATION</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    };</div>
</div><!-- fragment --><p> <code>Base</code> is a type defined from the CRTP and that represents the inherited classes. If <code>Base</code> does not define <code>PROVIDES_ALGEBRAIC_SPHERE</code>, this line generates an error when compiling the program. For instance, compiling the type </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> Basket&lt;Point, WeightSmoothFunc, GLSParam&gt; FitSmoothOriented;</div>
</div><!-- fragment --><p> generates the following error: </p><div class="fragment"><div class="line">Building CXX <span class="keywordtype">object</span> /xxxxx/wrongType.cpp.o</div>
<div class="line">In file included from /xxxxx/wrongType.cpp:19:</div>
<div class="line">/xxxxx/ponca/<a class="code hl_namespace" href="namespacePonca.html">Ponca</a>/src/Fitting/gls.h:51:23: error: no member named <span class="stringliteral">&#39;PROVIDES_ALGEBRAIC_SPHERE&#39;</span> in <span class="stringliteral">&#39;Ponca::PrimitiveBase&lt;PointPositionNormal&lt;float, 3&gt;, Ponca::DistWeightFunc&lt;PointPositionNormal&lt;float, 3&gt;, Ponca::SmoothWeightKernel&lt;float&gt; &gt;, void&gt;&#39;</span></div>
<div class="line">        Check = Base::PROVIDES_ALGEBRAIC_SPHERE,</div>
<div class="line">                ~~~~~~^</div>
<div class="ttc" id="anamespacePonca_html"><div class="ttname"><a href="namespacePonca.html">Ponca</a></div><div class="ttdoc">This Source Code Form is subject to the terms of the Mozilla Public License, v.</div><div class="ttdef"><b>Definition</b> <a href="limitedPriorityQueue_8h_source.html#l00014">limitedPriorityQueue.h:14</a></div></div>
</div><!-- fragment --><p> The capability <code>PROVIDES_GLS_PARAMETRIZATION</code> tells that <a class="el" href="classPonca_1_1GLSParam.html" title="Growing Least Squares reparemetrization of the OrientedSphereFit.">GLSParam</a> provides the GLS parameterization <a class="el" href="citelist.html#CITEREF_Mellado:2012:GLS">[11]</a>, and other components can access the related information.</p>
<dl class="section note"><dt>Note</dt><dd>There is currently no formal description of the API provided by each capability. This will be fixed in upcoming releases. These relations are currently implicitly defined (and used), but not documented. For instance, a tool with the capability <code>PROVIDES_PRINCIPAL_CURVATURES</code> provides the following methods: <code>kmin()</code>, <code>kmax()</code>, <code>kminDirection()</code>, <code>kmaxDirection()</code>, <code>kMean()</code>, <code>GaussianCurvature()</code>, see <a class="el" href="classPonca_1_1CurvatureEstimatorBase.html" title="Base class for any 3d curvature estimator: holds ,  and associated vectors, such that .">CurvatureEstimatorBase</a>.</dd></dl>
<p>In order to ease tools combinations, each class declare a set of <em>required</em> and <em>provided</em> capabilities, as listed in the two following table:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Fit/Tool (used in <a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>)   </th><th class="markdownTableHeadNone">Requires   </th><th class="markdownTableHeadNone">Provides    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MeanPosition.html" title="Compute the barycenter of the input points.">MeanPosition</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>PROVIDES_MEAN_POSITION</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MeanNormal.html" title="Compute the barycenter of the input points + their normals.">MeanNormal</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>PROVIDES_MEAN_NORMAL</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1PrimitiveBase.html" title="Primitive base class.">PrimitiveBase</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>PROVIDES_PRIMITIVE_BASE</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1DryFit.html" title="Empty fitting object doing no computation.">DryFit</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PRIMITIVE_BASE</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1Plane.html" title="Implicit hyperplane defined by an homogeneous vector .">Plane</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PRIMITIVE_BASE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PLANE</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MeanPlaneFitImpl.html" title="Plane fitting procedure computing the mean position and orientation from oriented points.">Ponca::MeanPlaneFitImpl</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_MEAN_POSITION</code>,<code>PROVIDES_MEAN_NORMAL</code>,<code>PROVIDES_PLANE</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CovarianceFitBase.html" title="Procedure that compute and decompose the covariance matrix of the neighbors positions in .">CovarianceFitBase</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_MEAN_POSITION</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_POSITION_COVARIANCE</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CovarianceLineFitImpl.html" title="Line fitting procedure that minimize the orthogonal distance between the samples and the fitted primi...">Ponca::CovarianceLineFitImpl</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_LINE</code>,<code>PROVIDES_POSITION_COVARIANCE</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CovariancePlaneFitImpl.html" title="Plane fitting procedure using only points position.">Ponca::CovariancePlaneFitImpl</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PLANE</code>,<code>PROVIDES_POSITION_COVARIANCE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_TANGENT_PLANE_BASIS</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MongePatch.html" title="Extension to compute the best fit quadric on 3d points expressed as .">MongePatch</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_TANGENT_PLANE_BASIS</code>,<code>PROVIDES_PLANE</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1AlgebraicSphere.html" title="Algebraic Sphere primitive.">AlgebraicSphere</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PRIMITIVE_BASE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_ALGEBRAIC_SPHERE</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1SphereFitImpl.html" title="Algebraic Sphere fitting procedure on point set without normals.">Ponca::SphereFitImpl</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_ALGEBRAIC_SPHERE</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1OrientedSphereFitImpl.html" title="Algebraic Sphere fitting procedure on oriented point sets.">Ponca::OrientedSphereFitImpl</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_ALGEBRAIC_SPHERE</code>,<code>PROVIDES_MEAN_NORMAL</code>,<code>PROVIDES_MEAN_POSITION</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1UnorientedSphereFitImpl.html" title="Algebraic Sphere fitting procedure on point sets with non-oriented normals.">Ponca::UnorientedSphereFitImpl</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_ALGEBRAIC_SPHERE</code>,<code>PROVIDES_MEAN_POSITION</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1GLSParam.html" title="Growing Least Squares reparemetrization of the OrientedSphereFit.">GLSParam</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_ALGEBRAIC_SPHERE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_GLS_PARAMETRIZATION</code>   </td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Fit/Tool (used in <a class="el" href="classPonca_1_1BasketDiff.html" title="Aggregator class used to declare specialized structures with derivatives computations,...">BasketDiff</a>)   </th><th class="markdownTableHeadNone">Requires   </th><th class="markdownTableHeadNone">Provides    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1PrimitiveDer.html" title="Generic class performing the Fit derivation.">PrimitiveDer</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PRIMITIVE_BASE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PRIMITIVE_DERIVATIVE</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CovarianceFitDer.html" title="Internal generic class computing the derivatives of covariance matrix computed by CovarianceFitBase.">CovarianceFitDer</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PRIMITIVE_DERIVATIVE</code>,<code>PROVIDES_MEAN_POSITION_DERIVATIVE</code>,<code>PROVIDES_POSITION_COVARIANCE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_POSITION_COVARIANCE_DERIVATIVE</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CovariancePlaneDerImpl.html" title="[CovariancePlaneFit Definition]">Ponca::CovariancePlaneDerImpl</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PLANE</code>,<code>PROVIDES_POSITION_COVARIANCE_DERIVATIVE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_COVARIANCE_PLANE_DERIVATIVE</code>,<code>PROVIDES_NORMAL_DERIVATIVE</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1OrientedSphereDerImpl.html" title="[OrientedSphereFit Definition]">Ponca::OrientedSphereDerImpl</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_ALGEBRAIC_SPHERE</code>,<code>PROVIDES_MEAN_POSITION_DERIVATIVE</code>,<code>PROVIDES_PRIMITIVE_DERIVATIVE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_ALGEBRAIC_SPHERE_DERIVATIVE</code>,<code>PROVIDES_NORMAL_DERIVATIVE</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1MlsSphereFitDer.html" title="Extension performing derivation of the mls surface.">MlsSphereFitDer</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PRIMITIVE_DERIVATIVE</code>,<code>PROVIDES_ALGEBRAIC_SPHERE_DERIVATIVE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_NORMAL_DERIVATIVE</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1GLSDer.html" title="Differentiation of GLSParam.">GLSDer</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_GLS_PARAMETRIZATION</code>,<code>PROVIDES_PRIMITIVE_DERIVATIVE</code>,<code>PROVIDES_ALGEBRAIC_SPHERE_DERIVATIVE</code>   </td><td class="markdownTableBodyNone"><code>PROVIDES_GLS_DERIVATIVE</code>,<code>PROVIDES_GLS_GEOM_VAR</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1CurvatureEstimatorBase.html" title="Base class for any 3d curvature estimator: holds ,  and associated vectors, such that .">CurvatureEstimatorBase</a>   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>PROVIDES_PRINCIPAL_CURVATURES</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1NormalDerivativesCurvatureEstimator.html" title="Extension to compute curvature values from the Weingarten map .">NormalDerivativesCurvatureEstimator</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_NORMAL_DERIVATIVE</code>,<code>PROVIDES_PRINCIPAL_CURVATURES</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1NormalCovarianceCurvatureEstimator.html" title="Extension to compute curvature values based on a covariance analysis of normal vectors of neighbors.">NormalCovarianceCurvatureEstimator</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PRINCIPAL_CURVATURES</code>   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="classPonca_1_1ProjectedNormalCovarianceCurvatureEstimator.html" title="Extension to compute curvature values based on a covariance analysis of normal vectors of neighbors p...">ProjectedNormalCovarianceCurvatureEstimator</a>   </td><td class="markdownTableBodyNone"><code>PROVIDES_PLANE</code>   </td><td class="markdownTableBodyNone"></td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>In its current version, the requirement/capability system offer limited protection over the combination of tools providing the same capabilities. Indeed, it is possible to build ill-formed combinations where two computations attempt to save their results at the same place, e.g. when using two fitting technique for the same primitive: <div class="fragment"><div class="line">    <span class="keyword">typedef</span> Basket&lt;Point, WeightConstantFunc, Plane,</div>
<div class="line">            MeanNormal, MeanPosition, MeanPlaneFitImpl,</div>
<div class="line">            CovarianceFitBase, CovariancePlaneFitImpl&gt; Hybrid1; <span class="comment">//test conflict detection in one direction</span></div>
</div><!-- fragment --> This case is not detected at compile time, but rather dynamically when calling finalize(), which can now return CONFLICT_ERROR_FOUND. Internally, this is implemented by checking if the primitive is already valid (ie. it has been computed already) when finalizing the computation. This limitation is expected to be resolved in upcoming releases.</dd></dl>
<h2><a class="anchor" id="fitting_multiprimitive"></a>
Sharing computations between fits</h2>
<p>In most cases, only one primitive is included in the <a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>, and it is recommended to use the helper classes provided by <a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> for fitting, e.g. <a class="el" href="classPonca_1_1CovariancePlaneFitImpl.html" title="Plane fitting procedure using only points position.">Ponca::CovariancePlaneFitImpl</a>, <a class="el" href="classPonca_1_1OrientedSphereFitImpl.html" title="Algebraic Sphere fitting procedure on oriented point sets.">Ponca::OrientedSphereFitImpl</a>. Starting from version 1.0.0, <a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> allows to combine multiple primitives. In order to share intermediate computation results, it is recommended to explicitly define the computational arrangement, e.g.: </p><div class="fragment"><div class="line">    <span class="comment">// Create an hybrid structure fitting a plane and a sphere at the same time</span></div>
<div class="line">    <span class="keyword">using </span>Hybrid = Basket&lt;Point, WeightFunc,</div>
<div class="line">                          AlgebraicSphere, Plane,                     <span class="comment">// primitives</span></div>
<div class="line">                          MeanNormal, MeanPosition,                   <span class="comment">// shared computation</span></div>
<div class="line">                          OrientedSphereFitImpl,                      <span class="comment">// sphere fitting</span></div>
<div class="line">                          CovarianceFitBase, CovariancePlaneFitImpl&gt;; <span class="comment">// plane fitting</span></div>
</div><!-- fragment --><h2><a class="anchor" id="fitting_cuvature"></a>
Computing Curvatures</h2>
<p><a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> offers several ways to compute curvatures, some of which are reviewed and compared by Lejemble et al. in <a class="el" href="citelist.html#CITEREF_Lejemble:2021:stable">[9]</a> and listed in the table below: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Estimator Name   </th><th class="markdownTableHeadNone">Estimated quantities   </th><th class="markdownTableHeadNone">Usage   </th><th class="markdownTableHeadNone">Speed   </th><th class="markdownTableHeadNone">Robustness    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Distance to PCA plane <a class="el" href="citelist.html#CITEREF_Digne:2011:scalespacemeshing">[5]</a>   </td><td class="markdownTableBodyNone">Mean curvature   </td><td class="markdownTableBodyNone"><code><a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>&lt;P,W,CovariancePlaneFit&gt; // method potential()</code>   </td><td class="markdownTableBodyNone">+++   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Surface Variation <a class="el" href="citelist.html#CITEREF_Pauly:2002:PSSimplification">[13]</a>   </td><td class="markdownTableBodyNone">Mean curvature   </td><td class="markdownTableBodyNone"><code><a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>&lt;P,W,CovariancePlaneFit&gt; // method surfaceVariation()</code>   </td><td class="markdownTableBodyNone">+++   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Growing Least Squares <a class="el" href="citelist.html#CITEREF_Mellado:2012:GLS">[11]</a>   </td><td class="markdownTableBodyNone">Mean curvature   </td><td class="markdownTableBodyNone"><code><a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>&lt;P,W,OrientedSphereFit,<a class="el" href="classPonca_1_1GLSParam.html" title="Growing Least Squares reparemetrization of the OrientedSphereFit.">GLSParam</a>&gt; // method kappa()</code>   </td><td class="markdownTableBodyNone">++   </td><td class="markdownTableBodyNone">+ +    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Point Set Surfaces (PSS) <a class="el" href="citelist.html#CITEREF_Alexa:2001:Pss">[2]</a>   </td><td class="markdownTableBodyNone">Curvature Tensor   </td><td class="markdownTableBodyNone"><code><a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>&lt;P,W,CovariancePlaneFit,CovariancePlaneSpaceDer,<a class="el" href="classPonca_1_1CurvatureEstimatorBase.html" title="Base class for any 3d curvature estimator: holds ,  and associated vectors, such that .">CurvatureEstimatorBase</a>,<a class="el" href="classPonca_1_1NormalDerivativesCurvatureEstimator.html" title="Extension to compute curvature values from the Weingarten map .">NormalDerivativesCurvatureEstimator</a>&gt;</code>   </td><td class="markdownTableBodyNone">+++   </td><td class="markdownTableBodyNone">+    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Algebraic Point Set Surfaces (APSS) <a class="el" href="citelist.html#CITEREF_Guennebaud:2007:APSS">[6]</a>   </td><td class="markdownTableBodyNone">Curvature Tensor   </td><td class="markdownTableBodyNone"><code><a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>&lt;P,W,OrientedSphereFit,OrientedSphereSpaceDer,<a class="el" href="classPonca_1_1CurvatureEstimatorBase.html" title="Base class for any 3d curvature estimator: holds ,  and associated vectors, such that .">CurvatureEstimatorBase</a>,<a class="el" href="classPonca_1_1NormalDerivativesCurvatureEstimator.html" title="Extension to compute curvature values from the Weingarten map .">NormalDerivativesCurvatureEstimator</a>&gt;</code>   </td><td class="markdownTableBodyNone">++   </td><td class="markdownTableBodyNone">+ +    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Algebraic Shape Operator (ASO) <a class="el" href="citelist.html#CITEREF_Lejemble:2021:stable">[9]</a>   </td><td class="markdownTableBodyNone">Curvature Tensor   </td><td class="markdownTableBodyNone"><code><a class="el" href="classPonca_1_1Basket.html" title="Aggregator class used to declare specialized structures using CRTP.">Basket</a>&lt;P,W,OrientedSphereFit,OrientedSphereSpaceDer,<a class="el" href="classPonca_1_1MlsSphereFitDer.html" title="Extension performing derivation of the mls surface.">MlsSphereFitDer</a>,<a class="el" href="classPonca_1_1CurvatureEstimatorBase.html" title="Base class for any 3d curvature estimator: holds ,  and associated vectors, such that .">CurvatureEstimatorBase</a>,<a class="el" href="classPonca_1_1NormalDerivativesCurvatureEstimator.html" title="Extension to compute curvature values from the Weingarten map .">NormalDerivativesCurvatureEstimator</a>&gt;</code>   </td><td class="markdownTableBodyNone">+   </td><td class="markdownTableBodyNone">+ + +   </td></tr>
</table>
<div class="image">
<img src="buste.png" alt=""/>
<div class="caption">
Figure 3. Example of mean curvature (GLSParam::kappa) computed at a fine (left) and a coarse (right) scale, and rendered with a simple color map (orange for concavities, blue for convexities).</div></div>
<h2><a class="anchor" id="fitting_cuda"></a>
Cuda</h2>
<p><a class="el" href="namespacePonca.html" title="This Source Code Form is subject to the terms of the Mozilla Public License, v.">Ponca</a> can be used directly on GPU, thanks to several mechanisms:</p><ul>
<li>Eigen Cuda capabilities, see <a href="http://eigen.tuxfamily.org/dox-devel/TopicCUDA.html" target="_blank">Eigen documentation</a> for more details. You <em>need</em> to use a consistent <code>Eigen::Index</code> on both CPU and GPU if you plan to transfer memory between the computing units. That's why we recommend to set the following preprocessor variable when compiling your project: <div class="fragment"><div class="line">-DEIGEN_DEFAULT_DENSE_INDEX_TYPE=<span class="keywordtype">int</span></div>
</div><!-- fragment --> You might also need to define the <code>--expt-relaxed-constexpr</code> preprocessor option for <code>NVCC</code>. Example of working cmake file (see <a class="el" href="example_cu_ssc_page.html">Screen Space Curvature using Cuda/C++</a>): <div class="fragment"><div class="line">enable_language(CUDA)</div>
<div class="line">add_executable(ponca_ssgls <span class="stringliteral">&quot;ponca_ssgls.cu&quot;</span>)</div>
<div class="line">target_compile_options(ponca_ssgls PRIVATE --expt-relaxed-<span class="keyword">constexpr</span>)</div>
</div><!-- fragment --></li>
<li>Automatic CPU/GPU compilation qualifiers. We use the macro <div class="fragment"><div class="line">PONCA_MULTIARCH <span class="keywordtype">void</span> function();</div>
</div><!-- fragment --> to use the same code for C++ and CUDA. It has no effect when the code is compiled with GCC or Clang, but it will force the compilation for both host and device architectures when compiling with nvcc. A similar macro system is provided for mathematical functions, to switch between STL and CUDA versions.</li>
</ul>
<p>Check the <a class="el" href="example_cu_ssc_page.html#cu_ssgl_intro_sec">C++/Cuda</a> and <a class="el" href="example_python_ssc_page.html">Python/Cuda</a> (using PyCuda) examples for more details and how-to.</p>
<hr  />
 <center>[<a class="el" href="fitting_concepts.html">Go to concept page</a>]</center> <center>[<a class="el" href="user_manual_page.html">Go back to user manual</a>]</center> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="user_manual_page.html">User Manual</a></li>
    <li class="footer">Generated on Wed Sep 17 2025 13:06:41 for Ponca by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
